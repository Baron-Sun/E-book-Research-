{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\Repos\\\\Projects\\\\test-ebook-4\\\\ebook0925\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Spin,Modal,message,Button}from\"antd\";import*as BooksAPI from'../../utils/BooksAPI';import BookService from'../../service/book';import{groupBy}from'../../utils';import BookItem from'../../components/BookCard/BookCard';import'./Home.css';var BooksApp=/*#__PURE__*/function(_React$Component){_inherits(BooksApp,_React$Component);var _super=_createSuper(BooksApp);function BooksApp(){var _this;_classCallCheck(this,BooksApp);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={bookList:[],visible:window.location.pathname==='/home'?false:true,videoVisible:false};_this.getBookList=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$BookService$ge,success,data,msg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return BookService.getList();case 2:_yield$BookService$ge=_context.sent;success=_yield$BookService$ge.success;data=_yield$BookService$ge.data;msg=_yield$BookService$ge.msg;if(success){_this.setState({bookList:data});}else{message.error(\"\".concat(msg));}case 7:case\"end\":return _context.stop();}}},_callee);}));_this.handleOk=function(e){_this.setState({visible:false,videoVisible:true});};_this.handleCancel=function(e){_this.setState({visible:false});};_this.videoHandleCancel=function(){_this.setState({videoVisible:false});};return _this;}_createClass(BooksApp,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.getBookList();var data=this.props.location.data;console.log(\"-----------------------\");console.log(data);console.log(\"-----------------------\");if(data){this.setState({userType:data.userType},function(){console.log(_this2.state.userType,'userType');});}else{//Default to video A\nthis.setState({userType:1},function(){console.log(_this2.state.userType,'userType');});}}// getBookList = async () => {\n//     let bookList = await BooksAPI.getAll()\n//     let bookGroups = groupBy(bookList, 'shelf')\n//     this.setState({\n//         bookList: bookList,\n//         bookGroups: bookGroups\n//     })\n// }\n//请求列表数据\n},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,bookList=_this$state.bookList,visible=_this$state.visible,videoVisible=_this$state.videoVisible,userType=_this$state.userType;return/*#__PURE__*/React.createElement(\"div\",{className:\"home-books-results\"},!videoVisible&&!visible&&/*#__PURE__*/React.createElement(Spin,{tip:\"\\u52A0\\u8F7D\\u4E2D...\",spinning:bookList.length>0?false:true},/*#__PURE__*/React.createElement(\"ol\",{className:\"books-grid\"},// 🔧 fix2:  Search results are not shown when all of the text is deleted out of the search input box.\nbookList.map(function(bookItem){return/*#__PURE__*/React.createElement(BookItem,{key:bookItem.id,bookList:bookList,getBookList:_this3.getBookList,bookItem:bookItem});}))),/*#__PURE__*/React.createElement(Modal,{title:null,visible:visible,onOk:this.handleOk,closable:false,onCancel:this.handleCancel,bodyStyle:{textAlign:'center'},footer:[/*#__PURE__*/React.createElement(Button,{key:\"submit\",type:\"primary\",onClick:this.handleOk},\"\\u786E\\u5B9A\")]},\"\\u5F00\\u59CB\\u5B9E\\u9A8C\\u524D\\u8BF7\\u60A8\\u89C2\\u770B\\u672C\\u7CFB\\u7EDF\\u6559\\u5B66\\u89C6\\u9891\"),/*#__PURE__*/React.createElement(Modal,{title:null,width:'70%',visible:videoVisible,onCancel:this.videoHandleCancel,footer:null,destroyOnClose:true},/*#__PURE__*/React.createElement(\"video\",{style:{width:'100%',height:'100%',outline:'unset'},controls:true},userType!=1&&/*#__PURE__*/React.createElement(\"source\",{src:\"/video.mp4\",type:\"video/mp4\"}),userType==1&&/*#__PURE__*/React.createElement(\"source\",{src:\"/videoB.mp4\",type:\"video/mp4\"}))));}}]);return BooksApp;}(React.Component);export default BooksApp;","map":{"version":3,"sources":["D:/Repos/Projects/test-ebook-4/ebook0925/src/pages/Home/Home.js"],"names":["React","Spin","Modal","message","Button","BooksAPI","BookService","groupBy","BookItem","BooksApp","state","bookList","visible","window","location","pathname","videoVisible","getBookList","getList","success","data","msg","setState","error","handleOk","e","handleCancel","videoHandleCancel","props","console","log","userType","length","map","bookItem","id","textAlign","width","height","outline","Component"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Spin, Modal, message, Button } from \"antd\"\r\nimport * as BooksAPI from '../../utils/BooksAPI'\r\nimport BookService from '../../service/book'\r\n\r\nimport { groupBy } from '../../utils'\r\nimport BookItem from '../../components/BookCard/BookCard'\r\nimport './Home.css'\r\n\r\nclass BooksApp extends React.Component {\r\n    state = {\r\n        bookList: [],\r\n        visible: window.location.pathname === '/home' ? false : true,\r\n        videoVisible: false,\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getBookList()\r\n        const {data} = this.props.location\r\n        console.log(\"-----------------------\");\r\n        console.log(data);\r\n        console.log(\"-----------------------\");\r\n        if(data) {\r\n            this.setState({userType: data.userType}, () => {\r\n                console.log(this.state.userType, 'userType');\r\n            });\r\n        } else {\r\n            //Default to video A\r\n            this.setState({userType: 1}, () => {\r\n                console.log(this.state.userType, 'userType');\r\n            });\r\n        }\r\n    }\r\n\r\n\r\n    // getBookList = async () => {\r\n    //     let bookList = await BooksAPI.getAll()\r\n\r\n    //     let bookGroups = groupBy(bookList, 'shelf')\r\n    //     this.setState({\r\n    //         bookList: bookList,\r\n    //         bookGroups: bookGroups\r\n    //     })\r\n    // }\r\n\r\n    //请求列表数据\r\n    getBookList = async () => {\r\n\r\n        const { success, data, msg } = await BookService.getList()\r\n        if (success) {\r\n            this.setState({\r\n                bookList: data,\r\n            })\r\n        } else {\r\n            message.error(`${msg}`)\r\n        }\r\n\r\n    }\r\n\r\n    handleOk = e => {\r\n        this.setState({\r\n            visible: false,\r\n            videoVisible: true\r\n        });\r\n    };\r\n\r\n    handleCancel = e => {\r\n        this.setState({\r\n            visible: false,\r\n        });\r\n    };\r\n    videoHandleCancel = () => {\r\n        this.setState({\r\n            videoVisible: false,\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const { bookList, visible, videoVisible, userType } = this.state\r\n        return (\r\n            <div className=\"home-books-results\">\r\n                {(!videoVisible && !visible) && <Spin tip=\"加载中...\" spinning={bookList.length > 0 ? false : true}>\r\n                    <ol className=\"books-grid\">\r\n                        {\r\n                            // 🔧 fix2:  Search results are not shown when all of the text is deleted out of the search input box.\r\n                            bookList.map(bookItem => <BookItem key={bookItem.id} bookList={bookList} getBookList={this.getBookList} bookItem={bookItem} />)\r\n                        }\r\n                    </ol>\r\n                </Spin>}\r\n                <Modal\r\n                    title={null}\r\n                    visible={visible}\r\n                    onOk={this.handleOk}\r\n                    closable={false}\r\n                    onCancel={this.handleCancel}\r\n                    bodyStyle={{ textAlign: 'center' }}\r\n                    footer={[\r\n                        <Button key=\"submit\" type=\"primary\" onClick={this.handleOk}>\r\n                            确定\r\n                        </Button>]}\r\n                >\r\n                    开始实验前请您观看本系统教学视频\r\n                </Modal>\r\n                <Modal\r\n                    title={null}\r\n                    width={'70%'}\r\n                    visible={videoVisible}\r\n                    onCancel={this.videoHandleCancel}\r\n                    footer={null}\r\n                    destroyOnClose={true}\r\n                >\r\n                    <video style={{ width: '100%', height: '100%', outline: 'unset' }} controls>\r\n                        {/*<source src='/video.mp4' type=\"video/mp4\" />*/}\r\n                        {userType != 1 && <source src='/video.mp4' type=\"video/mp4\" />}\r\n                        {userType == 1 && <source src='/videoB.mp4' type=\"video/mp4\" />}\r\n                    </video>\r\n                </Modal>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default BooksApp\r\n"]},"metadata":{},"sourceType":"module"}