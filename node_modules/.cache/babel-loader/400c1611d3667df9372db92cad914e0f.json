{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Spin,Modal,message,Button}from\"antd\";import*as BooksAPI from'../../utils/BooksAPI';import BookService from'../../service/book';import{groupBy}from'../../utils';import BookItem from'../../components/BookCard/BookCard';import'./Home.css';var BooksApp=/*#__PURE__*/function(_React$Component){_inherits(BooksApp,_React$Component);var _super=_createSuper(BooksApp);function BooksApp(){var _this;_classCallCheck(this,BooksApp);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={bookList:[],visible:window.location.pathname==='/home'?false:true,videoVisible:false};_this.getBookList=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$BookService$ge,success,data,msg;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return BookService.getList();case 2:_yield$BookService$ge=_context.sent;success=_yield$BookService$ge.success;data=_yield$BookService$ge.data;msg=_yield$BookService$ge.msg;if(success){_this.setState({bookList:data});}else{message.error(\"\".concat(msg));}case 7:case\"end\":return _context.stop();}}},_callee);}));_this.handleOk=function(e){_this.setState({visible:false,videoVisible:true});};_this.handleCancel=function(e){_this.setState({visible:false});};_this.videoHandleCancel=function(){_this.setState({videoVisible:false});};return _this;}_createClass(BooksApp,[{key:\"componentDidMount\",value:function componentDidMount(){this.getBookList();}// getBookList = async () => {\n//     let bookList = await BooksAPI.getAll()\n//     let bookGroups = groupBy(bookList, 'shelf')\n//     this.setState({\n//         bookList: bookList,\n//         bookGroups: bookGroups\n//     })\n// }\n//请求列表数据\n},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,bookList=_this$state.bookList,visible=_this$state.visible,videoVisible=_this$state.videoVisible;return/*#__PURE__*/React.createElement(\"div\",{className:\"home-books-results\"},!videoVisible&&!visible&&/*#__PURE__*/React.createElement(Spin,{tip:\"\\u52A0\\u8F7D\\u4E2D...\",spinning:bookList.length>0?false:true},/*#__PURE__*/React.createElement(\"ol\",{className:\"books-grid\"},// 🔧 fix2:  Search results are not shown when all of the text is deleted out of the search input box.\nbookList.map(function(bookItem){return/*#__PURE__*/React.createElement(BookItem,{key:bookItem.id,bookList:bookList,getBookList:_this2.getBookList,bookItem:bookItem});}))),/*#__PURE__*/React.createElement(Modal,{title:null,visible:visible,onOk:this.handleOk,closable:false,onCancel:this.handleCancel,bodyStyle:{textAlign:'center'},footer:[/*#__PURE__*/React.createElement(Button,{key:\"submit\",type:\"primary\",onClick:this.handleOk},\"\\u786E\\u5B9A\")]},\"\\u5F00\\u59CB\\u5B9E\\u9A8C\\u524D\\u8BF7\\u60A8\\u89C2\\u770B\\u672C\\u7CFB\\u7EDF\\u6559\\u5B66\\u89C6\\u9891\"),/*#__PURE__*/React.createElement(Modal,{title:null,width:'70%',visible:videoVisible,onCancel:this.videoHandleCancel,footer:null,destroyOnClose:true},/*#__PURE__*/React.createElement(\"video\",{style:{width:'100%',height:'100%',outline:'unset'},controls:true},/*#__PURE__*/React.createElement(\"source\",{src:\"/video.mp4\",type:\"video/mp4\"}))));}}]);return BooksApp;}(React.Component);export default BooksApp;","map":{"version":3,"sources":["/Users/bolunsun/Downloads/ebook_backup-master/src/pages/Home/Home.js"],"names":["React","Spin","Modal","message","Button","BooksAPI","BookService","groupBy","BookItem","BooksApp","state","bookList","visible","window","location","pathname","videoVisible","getBookList","getList","success","data","msg","setState","error","handleOk","e","handleCancel","videoHandleCancel","length","map","bookItem","id","textAlign","width","height","outline","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Spin, Modal, message, Button } from \"antd\"\nimport * as BooksAPI from '../../utils/BooksAPI'\nimport BookService from '../../service/book'\n\nimport { groupBy } from '../../utils'\nimport BookItem from '../../components/BookCard/BookCard'\nimport './Home.css'\n\nclass BooksApp extends React.Component {\n    state = {\n        bookList: [],\n        visible: window.location.pathname === '/home' ? false : true,\n        videoVisible: false\n    }\n\n    componentDidMount() {\n        this.getBookList()\n    }\n\n\n    // getBookList = async () => {\n    //     let bookList = await BooksAPI.getAll()\n\n    //     let bookGroups = groupBy(bookList, 'shelf')\n    //     this.setState({\n    //         bookList: bookList,\n    //         bookGroups: bookGroups\n    //     })\n    // }\n\n    //请求列表数据\n    getBookList = async () => {\n\n        const { success, data, msg } = await BookService.getList()\n        if (success) {\n            this.setState({\n                bookList: data,\n            })\n        } else {\n            message.error(`${msg}`)\n        }\n\n    }\n\n    handleOk = e => {\n        this.setState({\n            visible: false,\n            videoVisible: true\n        });\n    };\n\n    handleCancel = e => {\n        this.setState({\n            visible: false,\n        });\n    };\n    videoHandleCancel = () => {\n        this.setState({\n            videoVisible: false,\n        });\n    }\n\n    render() {\n        const { bookList, visible, videoVisible } = this.state\n        return (\n            <div className=\"home-books-results\">\n                {(!videoVisible && !visible) && <Spin tip=\"加载中...\" spinning={bookList.length > 0 ? false : true}>\n                    <ol className=\"books-grid\">\n                        {\n                            // 🔧 fix2:  Search results are not shown when all of the text is deleted out of the search input box.\n                            bookList.map(bookItem => <BookItem key={bookItem.id} bookList={bookList} getBookList={this.getBookList} bookItem={bookItem} />)\n                        }\n                    </ol>\n                </Spin>}\n                <Modal\n                    title={null}\n                    visible={visible}\n                    onOk={this.handleOk}\n                    closable={false}\n                    onCancel={this.handleCancel}\n                    bodyStyle={{ textAlign: 'center' }}\n                    footer={[\n                        <Button key=\"submit\" type=\"primary\" onClick={this.handleOk}>\n                            确定\n                        </Button>]}\n                >\n                    开始实验前请您观看本系统教学视频\n                </Modal>\n                <Modal\n                    title={null}\n                    width={'70%'}\n                    visible={videoVisible}\n                    onCancel={this.videoHandleCancel}\n                    footer={null}\n                    destroyOnClose={true}\n                >\n                    <video style={{ width: '100%', height: '100%', outline: 'unset' }} controls>\n                        <source src='/video.mp4' type=\"video/mp4\" />\n                    </video>\n                </Modal>\n            </div>\n        )\n    }\n}\n\nexport default BooksApp\n"]},"metadata":{},"sourceType":"module"}