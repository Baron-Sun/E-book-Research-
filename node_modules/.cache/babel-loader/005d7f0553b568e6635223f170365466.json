{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/bolunsun/Downloads/ebook_backup-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{UserOutlined,LockOutlined}from'@ant-design/icons';import{connect}from'react-redux';import{withRouter}from\"react-router-dom\";import LoginService from'../../../service/login';import{Form,Button,Input,Row,message}from'antd';import{setAuthUser}from'../../../actions/authUser';import{updateUserBookId}from'../../../actions/users';var LoginForm=/*#__PURE__*/function(_Component){_inherits(LoginForm,_Component);var _super=_createSuper(LoginForm);function LoginForm(){var _this;_classCallCheck(this,LoginForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={value:''};_this.generateDropdownData=function(){var users=_this.props.users;return users.map(function(user){return{key:user.id,text:user.name,value:user.id,image:{avatar:true,src:user.avatarURL}};});};return _this;}_createClass(LoginForm,[{key:\"handleSubmit\",value:function(){var _handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var _this2=this;var _this$props,setAuthUser,updateUserBookId,username,password,_yield$LoginService$p,success,_yield$LoginService$p2,detail;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=this.props,setAuthUser=_this$props.setAuthUser,updateUserBookId=_this$props.updateUserBookId;username=values.username,password=values.password;_context.next=4;return LoginService.post({username:username,password:password});case 4:_yield$LoginService$p=_context.sent;success=_yield$LoginService$p.success;_yield$LoginService$p2=_yield$LoginService$p.detail;detail=_yield$LoginService$p2===void 0?{}:_yield$LoginService$p2;if(success){message.success('登陆成功');setTimeout(function(){setAuthUser(\"\".concat(username));updateUserBookId(detail.bookPointer);_this2.props.history.push(\"/\");},500);}else{message.error('账号密码错误');}case 9:case\"end\":return _context.stop();}}},_callee,this);}));function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}return handleSubmit;}()},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(Form,{style:{'width':'100%'},onFinish:this.handleSubmit.bind(this),className:\"login-form\"},/*#__PURE__*/React.createElement(Form.Item,{name:\"username\",rules:[{required:true,message:'Please input your Username!'}]},/*#__PURE__*/React.createElement(Input,{style:{'borderRadius':'10px'},prefix:/*#__PURE__*/React.createElement(UserOutlined,{className:\"site-form-item-icon\"}),placeholder:\"Username\"})),/*#__PURE__*/React.createElement(Form.Item,{name:\"password\",rules:[{required:true,message:'Please input your Password!'}]},/*#__PURE__*/React.createElement(Input,{prefix:/*#__PURE__*/React.createElement(LockOutlined,{className:\"site-form-item-icon\"}),style:{'borderRadius':'10px'},type:\"password\",placeholder:\"Password\"})),/*#__PURE__*/React.createElement(Form.Item,null,/*#__PURE__*/React.createElement(Row,{justify:\"center\"},/*#__PURE__*/React.createElement(Button,{type:\"primary\",style:{background:\"orange\",borderColor:\"orange\",'borderRadius':'25px'},htmlType:\"submit\",className:\"login-form-button\"},\"Login\"))));}}]);return LoginForm;}(Component);export default connect(function(_ref){var users=_ref.users;return{users:Object.values(users)};},{setAuthUser:setAuthUser,updateUserBookId:updateUserBookId})(withRouter(LoginForm));","map":{"version":3,"sources":["/Users/bolunsun/Downloads/ebook_backup-master/src/pages/Login/LoginFrom/LoginFrom.js"],"names":["React","Component","UserOutlined","LockOutlined","connect","withRouter","LoginService","Form","Button","Input","Row","message","setAuthUser","updateUserBookId","LoginForm","state","value","generateDropdownData","users","props","map","user","key","id","text","name","image","avatar","src","avatarURL","values","username","password","post","success","detail","setTimeout","bookPointer","history","push","error","handleSubmit","bind","required","background","borderColor","Object"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { UserOutlined, LockOutlined } from '@ant-design/icons';\nimport { connect } from 'react-redux';\nimport { withRouter } from \"react-router-dom\";\nimport LoginService from '../../../service/login'\n\nimport {\n  Form,\n  Button,\n  Input,\n  Row,\n  message\n} from 'antd';\nimport { setAuthUser } from '../../../actions/authUser';\nimport { updateUserBookId } from '../../../actions/users';\n\nclass LoginForm extends Component {\n  static propTypes = {\n\n  };\n  state = {\n    value: ''\n  };\n  async handleSubmit(values) {\n\n    const { setAuthUser, updateUserBookId } = this.props;\n\n    const { username, password } = values\n\n    let { success, detail = {} } = await LoginService.post({ username, password })\n\n    if (success) {\n      message.success('登陆成功')\n      setTimeout(() => {\n        setAuthUser(`${username}`)\n        updateUserBookId(detail.bookPointer)\n        this.props.history.push(\"/\");\n      }, 500)\n\n    } else {\n      message.error('账号密码错误')\n    }\n\n  };\n  generateDropdownData = () => {\n    const { users } = this.props;\n\n    return users.map(user => ({\n      key: user.id,\n      text: user.name,\n      value: user.id,\n      image: { avatar: true, src: user.avatarURL }\n    }));\n  };\n  render() {\n\n    return (\n\n      <Form style={{ 'width': '100%' }} onFinish={this.handleSubmit.bind(this)} className=\"login-form\">\n        <Form.Item\n          name=\"username\"\n          rules={[\n            {\n              required: true,\n              message: 'Please input your Username!',\n            },\n          ]}\n        >\n          <Input style={{ 'borderRadius': '10px' }} prefix={<UserOutlined className=\"site-form-item-icon\" />} placeholder=\"Username\" />\n        </Form.Item>\n        <Form.Item\n          name=\"password\"\n          rules={[\n            {\n              required: true,\n              message: 'Please input your Password!',\n            },\n          ]}\n        >\n          <Input\n            prefix={<LockOutlined className=\"site-form-item-icon\" />}\n            style={{ 'borderRadius': '10px' }}\n            type=\"password\"\n            placeholder=\"Password\"\n          />\n        </Form.Item>\n        <Form.Item>\n          <Row justify=\"center\">\n            <Button type=\"primary\" style={{ background: \"orange\", borderColor: \"orange\", 'borderRadius': '25px' }} htmlType=\"submit\" className=\"login-form-button\">Login</Button>\n          </Row>\n        </Form.Item>\n      </Form>\n    );\n  }\n}\n\nexport default connect(\n  ({ users }) => ({\n    users: Object.values(users)\n  }),\n  { setAuthUser, updateUserBookId }\n)(withRouter(LoginForm));\n\n"]},"metadata":{},"sourceType":"module"}